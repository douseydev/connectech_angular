<div class="modal-overlay" *ngIf="isOpen" (click)="closeModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ isEditMode ? 'Modifier le produit' : 'Ajouter un produit' }}</h2>
      <button class="modal-close" (click)="closeModal()">✕</button>
    </div>

    <form class="modal-form" (ngSubmit)="submitForm()">
      <div class="form-group">
        <label for="name">Nom du produit *</label>
        <input type="text" id="name" [(ngModel)]="formData.name" name="name" placeholder="Ex: iPhone 15 Pro" required>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="category">Catégorie *</label>
          <select id="category" [(ngModel)]="formData.categoryId" name="categoryId" required>
            <option [ngValue]="null">Sélectionner une catégorie</option>
            <option *ngFor="let cat of categories" [ngValue]="cat.id">{{ cat.name }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="price">Prix (FCFA) *</label>
          <input type="number" id="price" [(ngModel)]="formData.price" name="price" placeholder="0" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="stock">Stock</label>
          <input type="number" id="stock" [(ngModel)]="formData.stock" name="stock" placeholder="0">
        </div>

        <!-- Référence (SKU) supprimée -->
      </div>

      <div class="form-group">
        <label for="image">Image du produit</label>
        <div class="file-upload-container">
          <input type="file" id="image" (change)="onFileSelected($event)" accept="image/*" class="file-input">
          <div class="image-preview" *ngIf="imagePreview">
            <img [src]="imagePreview" alt="Aperçu" style="max-height: 100px; max-width: 100%; object-fit: contain;">
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" [(ngModel)]="formData.description" name="description"
          placeholder="Description du produit..." rows="3"></textarea>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeModal()">Annuler</button>
        <button type="submit" class="btn btn-primary" [disabled]="!isFormValid()">
          {{ isEditMode ? 'Modifier' : 'Ajouter' }}
        </button>
      </div>
    </form>
  </div>
</div>