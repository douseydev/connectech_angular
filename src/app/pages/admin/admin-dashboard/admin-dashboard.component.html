<div class="admin-dashboard" *ngIf="isLoggedIn">
  <!-- SIDEBAR -->
  <app-admin-sidebar></app-admin-sidebar>

  <!-- MAIN CONTENT -->
  <div class="admin-container">
    <!-- PAGE HEADER -->
    <div class="page-header-admin">
      <div class="header-left">
        <h1>Tableau de bord</h1>
        <p class="header-subtitle">Bienvenue sur votre espace d'administration</p>
      </div>
      <div class="header-right">
        <div class="date-info">ðŸ“… {{ currentDate | date:'dd MMMM yyyy':'':'fr' }}</div>
      </div>
    </div>

    <div class="container">
      <!-- STATISTICS SECTION -->
      <section class="stats-section">
        <div class="section-title">AperÃ§u rapide</div>
        <div class="stats-grid">
          <div class="stat-card" *ngFor="let stat of stats" [class]="'stat-' + stat.type">
            <div class="stat-card-header">
              <div class="stat-icon-wrapper">
                <span class="stat-icon">
                  <!-- Products Icon -->
                  <svg *ngIf="stat.type === 'products'" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="24" height="24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                  </svg>
                  <!-- Categories Icon -->
                  <svg *ngIf="stat.type === 'categories'" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="24" height="24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581a1.125 1.125 0 001.591 0l4.318-4.318a1.125 1.125 0 000-1.591L9.581 3.659a2.25 2.25 0 00-1.591-.659V3z" />
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M10.875 12h.008v.008h-.008V12zm0-6.75h.008v.008h-.008V5.25z" />
                  </svg>
                  <!-- Messages Icon -->
                  <svg *ngIf="stat.type === 'messages'" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="24" height="24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3.091c-.333-.02-.667-.045-1-.072-1.133-.093-1.98-1.057-1.98-2.193V10.61c0-.969.616-1.813 1.5-2.097M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                  </svg>
                </span>
              </div>
              <span *ngIf="stat.trend !== undefined" class="stat-trend"
                [class]="stat.trend > 0 ? 'positive' : 'negative'">
                {{ stat.trend > 0 ? 'â†‘' : 'â†“' }} {{ Math.abs(stat.trend) }}%
              </span>
            </div>
            <div class="stat-info">
              <p class="stat-value">{{ stat.value }}</p>
              <p class="stat-label">{{ stat.label }}</p>
            </div>
            <div class="stat-footer">{{ stat.period }}</div>
          </div>
        </div>
      </section>

      <!-- (ancienne section de distribution enlevÃ©e) -->

      <!-- RÃ‰PARTITION PAR CATÃ‰GORIE -->
      <section class="content-section">
        <div class="section-header">
          <div class="section-header-left">
            <h2>RÃ©partition par catÃ©gorie</h2>
            <p class="section-subtitle">Distribution simple des produits par catÃ©gorie</p>
          </div>
        </div>

        <div class="category-grid">
          <div class="chart-left" *ngIf="categoryDistribution.length">
            <canvas id="categoryChart"></canvas>
          </div>

          <div class="category-distribution chart-right">
            <div *ngFor="let c of categoryDistribution" class="dist-row">
              <div class="dist-label">
                <span class="dot"></span>
                <strong>{{ c.category }}</strong>
                <span class="muted">({{ c.count }})</span>
              </div>
              <div class="dist-bar">
                <div class="dist-fill" [style.width.%]="c.percentage"></div>
              </div>
              <div class="dist-percent">{{ c.percentage }}%</div>
            </div>
            <div *ngIf="categoryDistribution.length === 0" class="empty-state">
              <p>Aucune donnÃ©e de catÃ©gorie disponible.</p>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>